---
import Bubbles from '@components/bubbles.jsx';

const { transition, is_first, is_last, index, background, prev, next, is_mini = false } = Astro.props;
---
<style lang="scss">
  $transition_swoosh: 12.5%;
  $transition_curve: 6.6%;

  .wrapper {
    position: relative;
    overflow: hidden;
    background: none;
    margin-bottom: 0;
  }

  // Transitions
  %transitions {
    .content {
      padding-bottom: 1px;
    }
  }

  .swoosh {
    @extend %transitions;
    margin-bottom: -($transition_swoosh);
    .svg {
      padding-bottom: $transition_swoosh;
    }
  }

  .curve {
    @extend %transitions;
    margin-bottom: -($transition_curve);
    .svg {
      padding-bottom: $transition_curve;
    }
  }

  // Styles
  .primary {
    @extend .wrapper;
    background: $color_primary;
  }

  .secondary {
    @extend .wrapper;
    background: $color_secondary;
  }

  .loud {
    @extend .wrapper;
    background: linear-gradient(0deg, $color_grad_1A, $color_grad_1B);
    margin-bottom: 0;
  }

  .content {
    padding-bottom: 4rem;
    padding-left: $layout_gutter;
    padding-right: $layout_gutter;
    max-width: $layout_max_width;
    margin: 0 auto;
    position: relative;
    z-index: 1;
    min-height: auto;

    &.content--curve {
      padding-top: $transition_curve;
    }
    &.content--swoosh {
      padding-top: $transition_swoosh;
    }
    &.content--loud {
      padding-top: 1px;
    }
  }

  .mini {
    max-width: $layout_max_width_small;
  }

  .svg {
    width: 100%;
    height: 0;
    position: relative;
    z-index: $zindex_background;
    
    /* SVG IMAGE RATIO HACK */
    /* allows the graphic to scale at 100% width - keeps the ratio */
    padding-bottom: 0;

    svg {
      position: absolute; 
      height: 100%; 
      width: 100%; 
      left: 0; 
      top: 0;
    }
  }
</style>

<section class:list={[ background, { [transition]: (!is_last && !!transition), is_mini } ]}>
  <div class:list={[ 'content', `content--${background}`, {} ]}>
  <!-- ${is_first && transition ? styles[`content--${transition}`] : styles[`content--${prev?.transition}`]}`}> -->
    <slot />
  </div>
  { background === 'loud' && (
    <Bubbles client:visible />
  )}
  { !is_last && !!transition && (
    <div class="svg">
      <svg>
        <use xlink:href={`#${transition}-${background}${background === 'loud' ? `-${next?.background}` : ''}`}></use>
      </svg>
    </div>
  )}
</section>
